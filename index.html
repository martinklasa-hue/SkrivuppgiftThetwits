<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>The Twits ‚Äì Essay App</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
:root {
  --bg:#f4f5fb; --card:#ffffff; --accent:#4f46e5;
  --accent2:#e0e7ff; --accent3:#4338ca;
  --text:#111; --muted:#666; --border:#ddd;
  --ok:#15803d; --warn:#b45309; --danger:#b91c1c;
}
body {
  margin:0; font-family:system-ui,sans-serif;
  background:radial-gradient(circle at top,#e0e7ff 0,#f4f5fb 45%,#f9fafb 100%);
  display:flex; justify-content:center; padding:24px;
}
.app {
  width:100%; max-width:1100px; background:rgba(255,255,255,0.92);
  backdrop-filter:blur(14px); border-radius:24px; padding:24px;
  box-shadow:0 18px 45px rgba(0,0,0,0.12);
}
header{display:flex;flex-wrap:wrap;justify-content:space-between;gap:14px;}
.title-pill{background:var(--accent2);color:var(--accent3);padding:3px 8px;
  border-radius:999px;font-size:.75rem;font-weight:600;}
.student-info{display:flex;gap:10px;flex-wrap:wrap;}
.student-info input{padding:6px 10px;border-radius:999px;border:1px solid var(--border);}

main{display:grid;grid-template-columns:1fr 320px;gap:16px;}
@media(max-width:900px){main{grid-template-columns:1fr;}}

.card{
  background:var(--card);padding:20px;border-radius:20px;
  box-shadow:0 10px 25px rgba(0,0,0,0.08);
}
.step{display:none;} .step.active{display:block;}
.field-group{margin-top:10px;display:flex;flex-direction:column;gap:4px;}
textarea,input[type=text]{
  border:1px solid #ddd;border-radius:10px;padding:8px;
  background:#fafafa;resize:vertical;font-family:inherit;font-size:0.9rem;
}
textarea{min-height:70px;}
textarea.essay{min-height:300px;} /* st√∂rre skrivruta */

button{
  border:none;cursor:pointer;padding:8px 14px;font-weight:600;
  border-radius:999px;transition:.15s;
}
.primary{background:var(--accent);color:#fff;}
.secondary{background:#e5e7eb;}
.primary:hover{background:var(--accent3);}

.word-count{margin-top:4px;font-size:.85rem;font-weight:600;}
.word-count.ok{color:var(--ok);}
.word-count.low,.word-count.high{color:var(--warn);}
.word-count.critical{color:var(--danger);}

.readonly{white-space:pre-wrap;background:#fafafa;padding:10px;
  border-radius:12px;border:1px solid #ddd;max-height:350px;overflow:auto;}

.tips{margin-top:12px;border:1px dashed #aac;border-radius:10px;padding:10px;}
.tips h4{margin:0 0 4px;font-size:0.95rem;}
.tips ul{margin:4px 0 0 18px;font-size:0.9rem;padding:0;}
.tips p{margin:4px 0;font-size:0.9rem;}
.small-muted{font-size:0.8rem;color:var(--muted);}
</style>
</head>

<body>
<div class="app">

<header>
  <div>
    <h1>The Twits ‚Äì Essay <span class="title-pill">Mr Muggle-Wump</span></h1>
    <p>Write your essay about life as a prisoner at the Twits‚Äô house ‚Äì and your escape.</p>
  </div>
  <div class="student-info">
    <div>
      <label>Name</label>
      <input id="student-name" type="text" placeholder="Your name" />
    </div>
    <div>
      <label>Class</label>
      <input id="student-class" type="text" placeholder="9A" />
    </div>
  </div>
</header>

<main>

<section class="card">

<!-- STEP 1 -->
<div class="step active" data-step="1">
  <h2>üé≠ Step 1 ‚Äì Quick warm-up</h2>
  <p>Write only 1‚Äì2 short sentences per box. This is just to get started.</p>

  <div class="field-group">
    <label>Who are you and where are you?</label>
    <small>Write as Mr Muggle-Wump.</small>
    <textarea id="role-who" placeholder="I am Mr Muggle-Wump..."></textarea>
  </div>

  <div class="field-group">
    <label>How do you feel as a prisoner? Why?</label>
    <small>Short answer.</small>
    <textarea id="role-feelings" placeholder="I feel... because..."></textarea>
  </div>

  <button class="primary" onclick="goStep(2)">Next ‚Üí</button>
</div>

<!-- STEP 2 -->
<div class="step" data-step="2">
  <h2>üß† Step 2 ‚Äì Short notes</h2>
  <p>Use these boxes to make quick notes that will help you write your essay in Step 3.  
     Only write a few words or very short sentences ‚Äì not a full text.</p>

  <div class="field-group">
    <label>The Twits‚Äô house and garden</label>
    <small>Short notes only (3‚Äì5 keywords or very short sentences).</small>
    <textarea id="plan-house"></textarea>
  </div>

  <div class="field-group">
    <label>How they treat you & other animals</label>
    <small>Short notes.</small>
    <textarea id="plan-treatment"></textarea>
  </div>

  <div class="field-group">
    <label>The Roly-Poly Bird</label>
    <small>Who helps you? A few words.</small>
    <textarea id="plan-bird"></textarea>
  </div>

  <div class="field-group">
    <label>Your plan to escape</label>
    <small>Brief notes.</small>
    <textarea id="plan-plan"></textarea>
  </div>

  <div class="field-group">
    <label>Your escape</label>
    <small>What happens in the end? Short notes.</small>
    <textarea id="plan-escape"></textarea>
  </div>

  <p class="small-muted">This is only your plan. The real writing happens in Step 3.</p>

  <button class="secondary" onclick="goStep(1)">‚Üê Back</button>
  <button class="primary" onclick="goStep(3)">Next ‚Üí</button>
</div>

<!-- STEP 3 -->
<div class="step" data-step="3">
  <h2>‚úçÔ∏è Step 3 ‚Äì Write your essay</h2>
  <p>Now write your full story as Mr Muggle-Wump. Aim for <strong>150‚Äì400 words</strong>.</p>

  textarea.essay {
  min-height: 300px;
  width: 100%;          /* g√∂r den lika bred som kortet */
  max-width: 100%;      /* hindrar att den krymper */
  box-sizing: border-box;
}

  <button class="secondary" onclick="goStep(2)">‚Üê Back</button>
  <button class="primary" onclick="goStep(4)">Next ‚Üí</button>
</div>

<!-- STEP 4 -->
<div class="step" data-step="4">
  <h2>‚úÖ Step 4 ‚Äì Check your text</h2>

  <div>
    <label><input type="checkbox" id="chk-spell"> Spelling checked</label><br>
    <label><input type="checkbox" id="chk-grammar"> Grammar checked (past tense, capital letters, full stops)</label><br>
    <label><input type="checkbox" id="chk-content"> Content: house & garden, treatment, Roly-Poly Bird, plan, escape</label><br>
    <label><input type="checkbox" id="chk-paragraphs"> Clear paragraphs</label><br>
    <label><input type="checkbox" id="chk-length"> Between 150‚Äì400 words</label>
  </div>

  <div class="field-group">
    <label>Note to teacher (optional)</label>
    <textarea id="note-teacher" placeholder="I am unsure about..."></textarea>
  </div>

  <button class="secondary" onclick="goStep(3)">‚Üê Back</button>
  <button class="primary" onclick="goStep(5)">I'm ready ‚Üí</button>
</div>

<!-- STEP 5 -->
<div class="step" data-step="5">
  <h2>üéâ Step 5 ‚Äì Final text</h2>
  
  <div class="readonly" id="final-text"></div>
  <button class="primary" onclick="copyEssay()">Copy essay</button>
  <button class="secondary" onclick="goStep(4)">‚Üê Back</button>
  <button class="secondary" onclick="resetAll()">Clear all data</button>

  <p id="copy-status" class="small-muted"></p>
  <p class="small-muted">Your work is automatically saved in this browser using local storage.</p>
</div>

</section>

<!-- RIGHT SIDEBAR -->
<aside class="card">
  <h3>üí° Help & structure</h3>

  <div class="tips">
    <h4>Structure ‚Äì example paragraphs</h4>
    <ul>
      <li>Paragraph 1: Life as a prisoner ‚Äì house, garden, the Twits, your feelings.</li>
      <li>Paragraph 2: How they treat you, your family and other animals.</li>
      <li>Paragraph 3: The Roly-Poly Bird and your plan.</li>
      <li>Paragraph 4: The escape and the ending.</li>
    </ul>
  </div>

  <div class="tips">
    <h4>Useful phrases</h4>
    <ul>
      <li>I feel‚Ä¶ because‚Ä¶</li>
      <li>Every day, I have to‚Ä¶</li>
      <li>They always‚Ä¶ / They never‚Ä¶</li>
      <li>Finally, we decided to‚Ä¶</li>
      <li>In the end‚Ä¶</li>
    </ul>
  </div>

  <div class="tips">
    <h4>Word count</h4>
    <p>The target is <strong>150‚Äì400 words</strong>.</p>
    <p class="small-muted">
      Fewer than 150 is usually too short. More than 400 can be hard to read ‚Äì try to be clear and effective.
      The counter updates automatically when you write.
    </p>
  </div>

  <div class="tips">
    <h4>Remember</h4>
    <ul>
      <li>You are Mr Muggle-Wump ‚Äì use ‚ÄúI‚Äù.</li>
      <li>Use past tense when you tell your story.</li>
      <li>Use full stops and capital letters.</li>
      <li>Think about feelings and details from the book.</li>
    </ul>
  </div>
</aside>

</main>
</div>

<script>
// STATE
const KEY="twitsEssayState";
let state={
  step:1, name:"", class:"",
  who:"", feel:"",
  house:"", treat:"", bird:"",
  plan:"", escape:"",
  essay:"", note:"",
  c1:false,c2:false,c3:false,c4:false,c5:false
};

// LOAD
function load(){
  let s=localStorage.getItem(KEY);
  if(s){ state={...state,...JSON.parse(s)} }
  fill();
  goStep(state.step);
}

// SAVE
function save(){
  localStorage.setItem(KEY,JSON.stringify(state));
}

// CHANGE STEP
function goStep(n){
  state.step=n; save();
  document.querySelectorAll(".step").forEach(el=>{
    el.classList.remove("active");
    if(el.dataset.step==n) el.classList.add("active");
  });
  if(n==5){
    document.getElementById("final-text").textContent=state.essay;
  }
}

// FILL FIELDS
function fill(){
  id("student-name").value=state.name;
  id("student-class").value=state.class;
  id("role-who").value=state.who;
  id("role-feelings").value=state.feel;
  id("plan-house").value=state.house;
  id("plan-treatment").value=state.treat;
  id("plan-bird").value=state.bird;
  id("plan-plan").value=state.plan;
  id("plan-escape").value=state.escape;
  id("essay-text").value=state.essay;
  id("note-teacher").value=state.note;

  chk("chk-spell").checked=state.c1;
  chk("chk-grammar").checked=state.c2;
  chk("chk-content").checked=state.c3;
  chk("chk-paragraphs").checked=state.c4;
  chk("chk-length").checked=state.c5;

  updateCount();
}

// SHORTCUTS
function id(x){return document.getElementById(x)}
function chk(x){return document.getElementById(x)}

// INPUT EVENTS
document.addEventListener("input", e=>{
  let t=e.target.id;
  if(t=="student-name") state.name=e.target.value;
  if(t=="student-class") state.class=e.target.value;
  if(t=="role-who") state.who=e.target.value;
  if(t=="role-feelings") state.feel=e.target.value;
  if(t=="plan-house") state.house=e.target.value;
  if(t=="plan-treatment") state.treat=e.target.value;
  if(t=="plan-bird") state.bird=e.target.value;
  if(t=="plan-plan") state.plan=e.target.value;
  if(t=="plan-escape") state.escape=e.target.value;
  if(t=="essay-text"){ state.essay=e.target.value; updateCount(); }
  if(t=="note-teacher") state.note=e.target.value;
  save();
});

// CHECKBOX EVENTS
document.addEventListener("change", e=>{
  let t=e.target.id;
  if(t=="chk-spell") state.c1=e.target.checked;
  if(t=="chk-grammar") state.c2=e.target.checked;
  if(t=="chk-content") state.c3=e.target.checked;
  if(t=="chk-paragraphs") state.c4=e.target.checked;
  if(t=="chk-length") state.c5=e.target.checked;
  save();
});

// WORD COUNT
function updateCount(){
  let w=state.essay.trim().split(/\s+/).filter(Boolean).length;
  let el=id("word-count");
  el.textContent="Words: "+w+" (target 150‚Äì400)";
  el.className="word-count";
  if(w===0) el.classList.add("critical");
  else if(w<150) el.classList.add("low");
  else if(w>400) el.classList.add("high");
  else el.classList.add("ok");
}

// COPY
function copyEssay(){
  if(!state.essay.trim()){
    id("copy-status").textContent="No text to copy.";
    return;
  }
  navigator.clipboard.writeText(state.essay).then(()=>{
    id("copy-status").textContent="Copied! You can paste it into Classroom/Teams.";
  }).catch(()=>{
    id("copy-status").textContent="Could not copy automatically. Select the text and copy it manually.";
  });
}

// RESET
function resetAll(){
  if(!confirm("Delete all saved work on this device?")) return;
  localStorage.removeItem(KEY);
  location.reload();
}

load();
</script>

</body>
</html>
